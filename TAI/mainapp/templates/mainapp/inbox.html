{% extends 'mainapp/base.html' %}
{% load static %}

{% block title %}Inbox | TypeAI{% endblock %}
{% block extra_head %}

<link rel ="stylesheet" href = "{% static 'mainapp\css\inbox.css' %}">

{% endblock %}
{% block content %}
<!-- make inbox title header, compose is on same level, can change if want, looks good to me tho-->
<div class="inbox-container">
    <div class="inbox-header">
        <h1>Inbox</h1>
        <a href="{% url 'send_message' %}" class="compose-btn">
            <i class="fas fa-pen"></i> Compose
        </a>
    </div>
    <!-- For received and how many messages are in each, was thinking of notifying if read but lazy...-->
    <div class="inbox-tabs">
        <div class="inbox-tab active" data-tab="received">
            Received {% if unread_count %}<span class="badge">({{ unread_count }} unread)</span>{% endif %}
        </div>
        <div class="inbox-tab" data-tab="sent">Sent</div>
    </div>
    
    <div class="inbox-content active" id="received-content">
        {% if received_messages %}
            <ul class="message-list">
                {% for message in received_messages %}
                <!-- give options for user to manage message, extend this to collab invite and complaints-->
                    <li class="message-item {% if not message.is_read %}unread{% endif %}">
                        <div class="message-sender">{{ message.sender.username }}</div>
                        <div class="message-subject">
                            <a href="{% url 'message_detail' message.id %}">{{ message.subject }}</a>
                        </div>
                        <!-- time really isn't needed for what we are doing but i was copying gmail, I mean referencing...-->
                        <div class="message-date">{{ message.timestamp|date:"M d, Y" }}</div>
                        <div class="message-actions">
                            <a href="{% url 'delete_message' message.id %}" onclick="return confirm('Are you sure you want to delete this message?')">
                                <i class="fas fa-trash"></i>
                            </a>
                        </div>
                    </li>
                {% endfor %}
            </ul>
        {% else %}
            <div class="no-messages">
                <p>No messages in your inbox</p>
            </div>
        {% endif %}
    </div>
    
    <!-- similar permissions for the sender-->
    <div class="inbox-content" id="sent-content">
        {% if sent_messages %}
            <ul class="message-list">
                {% for message in sent_messages %}
                    <li class="message-item">
                        <div class="message-sender">To: {{ message.recipient.username }}</div>
                        <div class="message-subject">
                            <a href="{% url 'message_detail' message.id %}">{{ message.subject }}</a>
                        </div>
                        <div class="message-date">{{ message.timestamp|date:"M d, Y" }}</div>
                        <div class="message-actions">
                            <a href="{% url 'delete_message' message.id %}" onclick="return confirm('Are you sure you want to delete this message?')">
                                <i class="fas fa-trash"></i>
                            </a>
                        </div>
                    </li>
                {% endfor %}
            </ul>
        {% else %}
            <div class="no-messages">
                <p>No sent messages</p>
            </div>
        {% endif %}
    </div>
</div>
{% endblock %}

{% block extra_scripts %}

<script src = "{% static 'mainapp/js/inbox.js' %}"></script>

{% endblock %}